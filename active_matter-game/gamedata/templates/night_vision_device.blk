nvd_up_animation{
  _use:t="replicated_game_effect_with_duration"
  game_effect__forceAnimState:t="nvd_up"
  game_effect__forceAnimStateId:i=-1
  game_effect__timeToDestroy:r=1
  nvd_animation__sequenceName:t="nvd_up_visual_sequence"

  "game_effect__destroyWithOwner:tag"{}
  "nvd_animation__nvdDevice:eid"{}
}

nvd_down_animation{
  _use:t="replicated_game_effect_with_duration"
  game_effect__forceAnimState:t="nvd_down"
  game_effect__forceAnimStateId:i=-1
  game_effect__timeToDestroy:r=1
  nvd_animation__sequenceName:t="nvd_down_visual_sequence"

  "game_effect__destroyWithOwner:tag"{}
  "nvd_animation__nvdDevice:eid"{}
}

nvd_up_visual_sequence{
  nvd_visual_sequence__state:i=0
  nvd_visual_sequence__curTime:r=0

  "nvd_visual_sequence__nvdDevice:eid"{}
  "nvd_visual_sequence__isUp:tag"{}
}

nvd_down_visual_sequence{
  nvd_visual_sequence__state:i=0
  nvd_visual_sequence__curTime:r=0

  "nvd_visual_sequence__nvdDevice:eid"{}
  "nvd_visual_sequence__isDown:tag"{}
}

night_vision_device_infrared_light_controller{
  night_vision_device__maxObstacleTraceDistance:r=30
  night_vision_device__nextObstacleTraceAt:r=0
  night_vision_device__obstacleTracesInterval:r=0.2
  night_vision_device__obstacleTraceSphereRadius:r=0.35
  night_vision_device__flashlightBrightnessRange:p2=5, 45.5
  night_vision_device__flashlightTargetBrightness:r=0
  night_vision_device__flashlightAdaptationFactor:r=3.5
}

night_vision_device_infrared_flashlight_spot_light{
  _use:t="controlled_infrared_flashlight_spot_light"

  "night_vision_device_infrared_flashlight_spot_light:tag"{}
}

attached_infrared_flashlight_controller{
  _tracked:t="attached_flashlight_controller__spotLightEid"
  _replicated:t="attached_flashlight_controller__spotLightEid"
  attached_flashlight_controller__spotLightTemplate:t="night_vision_device_infrared_flashlight_spot_light"
  attached_flashlight_controller__spotLightAttachNodeName:t="d_eye_l"
  attached_flashlight_controller__spotLightAttachNodeId:i=-1

  "attached_flashlight_controller__spotLightEid:eid"{}
  "attached_flashlight_controller__spotLightAttachEid:eid"{}
}

night_vision_device{
  _use:t="base_equipment_mod"
  _use:t="replicating"
  _use:t="night_vision_device_infrared_light_controller"
  _use:t="attached_infrared_flashlight_controller"
  _use:t="item_rarity_uncommon"
  item__recreateInEquipmentModSlot:t="visible_item_in_equipment_mod"
  night_vision_device__nightLightMult:r=0.08
  night_vision_device__nightLightDistanceMult:r=0.001
  night_vision_device__isOn:b=no
  _tracked:t="night_vision_device__isOn"
  _replicated:t="night_vision_device__isOn"
  item__proto:t="night_vision_device"
  item__name:t="items/night_vision_device1"
  item__weight:r=0.51
  item__volume:i=120
  item__marketPrice:i=3750
  item__iconPitch:r=-10
  item__iconRoll:r=40
  item__iconYaw:r=40
  item__iconScale:r=1.3
  item__iconOffset:p2=-0.05, -0.1
  item__filterType:t="equipment"
  animchar__res:t="psv7_char"
  collres__res:t="psv7_collision"
  slot_attach__slotName:t="psv"
  animchar_render__enabled:b=yes
  animchar__actWhenInvisible:b=yes
  slot_attach__ignoreParentVisibility:b=no
  _tracked:t="slot_attach__ignoreParentVisibility"
  showroom_item__customZoom:r=1.8
  showroom_item__customZoomBordersRng:p2=1.6, 2.2
  item__nexusCost:i=50

  "item__dropOnGroundIfParentDestroyed:tag"{}
  "night_vision_device:tag"{}
  "item__containerOwnerEid:eid"{}
  "slot_attach__secondaryUpdate:tag"{}
  "item__cantBeCorrupted:tag"{}
}

controlled_infrared_flashlight_spot_light{
  _use:t="controlled_flashlight_spot_light"
  light__radius_scale:r=3
  lightModTm:m=[[1, 0, 0] [0, 1, 0] [0, 0, 1] [0, 0, 0]]
  light__offset:p3=0, 0, 0.2
  flashlight_spot_light__type:i=1
  flashlight_spot_light__normalBrightness:r=0
  flashlight_spot_light__lightScale:r=0.5
  flashlight_spot_light__extraRotation:p3=-7, 0, 0
  light__color:c=255, 0, 0, 255
}

night_vision_device_slot{
  _use:t="base_equipment_mod_slot"
  mod_slot__icon:t="uiskin/night_vision_device.svg"
  mod_slot__tooltip:t="slots/night_vision_device"

  "slot_holder__availableItems:list<t>"{
    i:t="night_vision_device"
  }
}

enable_night_vision_affect{
  _use:t="game_effect_base"
  enable_night_vision_affect__fixed_exposure:r=3

  "enable_night_vision_affect:tag"{}
  "enable_night_vision_affect__preset:object"{
    screen_night_vision__mode:i=2
    screen_night_vision__dark_color:p4=0, 0, 0, 0
    screen_night_vision__light_color:p4=0.1, 0.1, 0.1, 0
    screen_night_vision__light_multiplier:r=10
    screen_night_vision__gamma_correction:r=0.7
    screen_night_vision__luminance_rgb_coef:p4=0.1, 0.1, 0.1, 0
    screen_night_vision__fog_color:p4=0.05, 0.05, 0.05, 0
    screen_night_vision__fog_clear_distance:r=0
    screen_night_vision__fog_opaque_distance:r=100
    screen_night_vision__left_ocular:p4=0.25, 0.5, 0, 0
    screen_night_vision__ocular_radius:r=0.25
    screen_night_vision__border_color:p4=0, 0.01, 0.02, 0
    screen_night_vision__border_blur:r=0.8
    screen_night_vision__border_opacity:r=0
    screen_night_vision__line_opacity:r=0.03
    screen_night_vision__line_height:r=0.9
    screen_night_vision__line_blur:r=0.9
    screen_night_vision__noise_fps:r=240
    screen_night_vision__noise_low_strength:r=0.01
    screen_night_vision__noise_high_strength:r=0.1
    screen_night_vision__noise_threshold:r=0.0001
    screen_night_vision__noise_pixelize:r=0.1
  }
}
